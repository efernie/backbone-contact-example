define(["jquery","underscore","backbone"],function(a,b,c){return{Router:{},Models:{},Collections:{},Views:{},Templates:{},Pages:{},loadPage:function(b,c){var d=this,e=a("#main");if(d.Pages[b])return e.empty().append(d.Pages[b]),c({error:!1});a.ajax({url:"partial/"+b,type:"GET",dataType:"html",beforeSend:function(){e.empty()},success:function(a){return d.Pages[b]=a,e.append(a),c({error:!1})},error:function(a){return c({error:!0})}})},errorHandler:function(b){console.log(b),a("#main").text("404")},indexPageHandler:function(c){var d=a("#main"),e=this;if(e.Pages.index)return d.empty().append(e.Pages.index),c();if(b.isEmpty(e.Pages)){var f=d.html();return e.Pages.index=f,c()}a.ajax({url:"/",type:"GET",dataType:"html",beforeSend:function(){d.empty()},success:function(a){var b=/<div id="main">/,f=/<footer>/,g=a.match(b).index,h=a.match(f).index,i=a.slice(g,h);return e.Pages.index=i,d.append(i),c()}})}}})