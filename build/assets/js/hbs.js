/**
 * @license handlebars hbs 0.2.1 - Alex Sexton, but Handlebars has it's own licensing junk
 *
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/require-cs for details on the plugin this was based off of
 */

define(["Handlebars","underscore","i18nprecompile","json2"],function(a,b,c,d){var e,f,g=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],h=function(){throw new Error("Environment unsupported.")},i=[],j="w+",k="hbs",l="@hbs",m="/demo/styles/",n="/demo-build/styles/",o="template/helpers/",p="template/i18n/",q="screen.build.css";typeof window!="undefined"&&window.navigator&&window.document&&!window.navigator.userAgent.match(/Node.js/)?(f=function(){var a,b,c;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(b=0;b<3;b++){c=g[b];try{a=new ActiveXObject(c)}catch(d){}if(a){g=[c];break}}if(!a)throw new Error("getXhr(): XMLHttpRequest not available");return a},h=function(a,b){var c=f();c.open("GET",a,!0),c.onreadystatechange=function(a){c.readyState===4&&b(c.responseText)},c.send(null)}):typeof process!="undefined"&&process.versions&&!!process.versions.node?(e=require.nodeRequire("fs"),h=function(a,b){b(e.readFileSync(a,"utf8"))}):typeof java!="undefined"&&typeof java.io!="undefined"&&(h=function(a,b){var c=new java.io.File(a),d=new java.io.FileReader(c),e=new java.io.BufferedReader(d),f,g="";while((f=e.readLine())!==null)g+=new String(f)+"\n";e.close(),b(g)});var r={},s=function(a,b){r[a]?b(r[a]):h(a,function(c){r[a]=c,b.call(this,c)})},t=[],u={};return{get:function(){return a},write:function(a,b,c){if(b+l in i){var d=i[b+l];c.asModule(a+"!"+b,d)}},version:"1.0.3beta",load:function(e,f,g,m){function x(a,c){return b(a).forEach(function(a){a&&a.type&&a.type==="partial"&&c.push(a.id.string),a&&a.program&&a.program.statements&&x(a.program.statements,c),a&&a.program&&a.program.inverse&&a.program.inverse.statements&&x(a.program.inverse.statements,c)}),c}function y(a){var c=[];return a&&a.statements&&(c=x(a.statements,[])),b(c).unique()}function z(a){var b,c,e;if(a&&a.statements){b=a.statements[0];if(b.type==="comment")try{return c=b.comment.replace(new RegExp("^[\\s]+|[\\s]+$","g"),""),e=d.parse(c),c}catch(f){return"{}"}}return"{}"}function A(a){if(!a)return[];var b=[a[0]],c=a[0],d;for(d=1;d<a.length;++d)a.hasOwnProperty(d)&&(c+="."+a[d],b.push(c));return b}function B(a,c,d,e){d=d?d+".":"";var f="",g=!1;return b(a).forEach(function(a){var g,h,i;if(a&&a.type&&a.type==="mustache"){if(!a.params||!a.params.length){g=A(a.id.parts);for(h in g)g[h]&&(f=g[h]||f,c.push(d+g[h]));c.push(d+a.id.string)}a.params&&b(a.params).forEach(function(b){g=A(b.parts);for(var h in g)g[h]&&(f=g[h]||f,e.push(a.id.string),c.push(d+g[h]))})}a&&a.mustache&&B([a.mustache],c,d+f,e),a&&a.program&&a.program.statements&&(i=B([a.mustache],[],"",e)[0]||"",B(a.program.statements,c,d+f+(i?d+f?"."+i:i:""),e))}),c}function C(a){var c=[],d=[];a&&a.statements&&(c=B(a.statements,[],undefined,d));var e=["helperMissing","blockHelperMissing","each","if","unless","with"];return{vars:b(c).chain().unique().map(function(a){return a===""?".":a.length&&a[a.length-1]==="."?a.substr(0,a.length-1)+"[]":a}).value(),helpers:b(d).chain().unique().map(function(a){return b(e).contains(a)?undefined:a}).compact().value()}}function D(k){h(E,function(h){var l=a.parse(h),p=y(l),s=z(l),w=C(l),x=w.vars,A=w.helpers||[],B=p.join("', 'hbs!").replace(/_/g,"/"),D=m.hbs&&m.hbs.disableHelpers?"":function(){var a,b=[],c=m.hbs&&m.hbs.helperPathCallback?m.hbs.helperPathCallback:function(a){return o+a};for(a=0;a<A.length;a++)b[a]="'"+c(A[a])+"'";return b}().join(","),F="",G="",H="",I,J,K;B&&(B=",'hbs!"+B+"'"),D&&(D=","+D);if(s!=="{}")try{I=d.parse(s),I&&I.styles&&(t=b.union(t,I.styles),require.isBrowser&&!m.isBuild?(J=document.head||document.getElementsByTagName("head")[0],b(I.styles).forEach(function(a){u[a]||(K=document.createElement("link"),K.href=m.baseUrl+"styles/"+a+".css",K.media="all",K.rel="stylesheet",K.type="text/css",J.appendChild(K),u[a]=K)})):m.isBuild&&function(){var a=require.nodeRequire("fs"),c=b(I.styles).map(function(a){return u[a]?"":(u[a]=!0,"@import url("+n+a+".css);\n")}).join("\n");a.open(__dirname+n+q,j,"0666",function(b,d){a.writeSync(d,c,null,encoding="utf8"),a.close(d)}),j="a"}())}catch(L){console.log("error injecting styles")}!m.isBuild&&!m.serverRender&&(F="<!-- START - "+e+" -->",G="<!-- END - "+e+" -->",H="t.meta = "+s+";\n"+"t.helpers = "+d.stringify(A)+";\n"+"t.deps = "+d.stringify(p)+";\n"+"t.vars = "+d.stringify(x)+";\n");var M=v?!1:b.extend(k,m.localeMapping),N=c(h,M);h="/* START_TEMPLATE */\ndefine(['hbs','Handlebars'"+B+D+"], function( hbs, Handlebars ){ \n"+"var t = Handlebars.template("+N+");\n"+"Handlebars.registerPartial('"+e.replace(/\//g,"_")+"', t);\n"+H+"return t;\n"+"});\n"+"/* END_TEMPLATE */\n",m.isBuild&&(i[r]=h),m.isBuild||(h+="\r\n//@ sourceURL="+E);for(var O in p)p.hasOwnProperty(O)&&(p[O]="hbs!"+p[O].replace(/_/g,"/"));m.isBuild?(g.fromText(r,h),f([r],function(a){g(a)})):require(p,function(){g.fromText(r,h),f([r],function(a){g(a)})})})}var r=e+l,v=m.hbs&&m.hbs.disableI18n,w=[],E=f.toUrl(e+"."+(m.hbs&&m.hbs.templateExtension?m.hbs.templateExtension:k));v?D(!1):s(f.toUrl(p+(m.locale||"en_us")+".json"),function(a){D(d.parse(a))})}}})